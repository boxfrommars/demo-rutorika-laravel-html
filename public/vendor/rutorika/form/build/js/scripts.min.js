$(document).ready(function(){ace.config.set("basePath","/vendor/rutorika/form/vendor/ace/src-noconflict/"),$(".rk-code-field").each(function(){var e=$(this),t=ace.edit(e.siblings(".rk-code").get(0));t.$blockScrolling=1/0;var a=e.data("mode")||"html",n=e.data("theme")||"textmate";t.setTheme("ace/theme/"+n),t.getSession().setMode("ace/mode/"+a),t.getSession().setValue(e.val()),t.getSession().on("change",function(){e.val(t.getSession().getValue())})})}),$(document).ready(function(){$(".rk-color-field").each(function(){var e=$(this),t=e.data("minicolors");t=$.extend({theme:"bootstrap"},t),e.minicolors(t)})}),$(function(){$(".rk-datetimepicker").each(function(){var e=$(this).find("input"),t=e.data("datetime");$(this).datetimepicker(t)})}),$(document).ready(function(){function e(e){return e?e.split(":"):null}$(".rk-geopoint-field").each(function(){function t(e){o?o.setLatLng(e):(o=L.marker(e,{draggable:!0}).addTo(c),o.on("dragend",function(e){var a=this.getLatLng();t(a),r.val(a.lat+":"+a.lng)})),c.panTo(e)}function a(){o&&(c.removeLayer(o),o=null)}function n(e,t,a){var n=r.data("type")||a;return t.indexOf(n)<0&&(console.warn(e+" doesnt support `"+n+"` type. Only "+t.join(" | ")+". Fallback to "+a),n=a),n}var o,r=$(this),i=$(this).siblings(".rk-map"),l=r.data("layer")||"osm",d=$.extend({center:[51.476852,-498e-6],zoom:12},r.data("map")||{}),s=e(r.val());s&&(d.center=s);var c=new L.Map(i.get(0),d);s&&t(s);var u,p;switch(l){case"yandex":p=n("Yandex",["map","satellite","hybrid","publicMap","publicMapHybrid"],"publicMap"),u=new L.Yandex(p);break;case"osm":p=r.data("type")||"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",0!==p.indexOf("http")&&0!==p.indexOf("//")&&(console.warn("OSM doesnt support `"+p+"` type. Fallback to http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),p="http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),u=new L.TileLayer(p);break;case"google":p=n("Google",["ROADMAP","SATELLITE","HYBRID","TERRAIN"],"ROADMAP"),u=new L.Google("ROADMAP");break;case"bing":p=n("Bing",["Road","Aerial","AerialWithLabels","Birdseye","BirdseyeWithLabels"],"Road"),u=new L.BingLayer("AvoUren6Dm0PAAyhkqPcEQs3PtNsC_VHqb2Pxyac59fd-YME_3FZ_6No4BL5iEAe",{type:p});break;default:console.warn("Layer `"+l+"` doesn't supported, you should use one of yandex, google, osm or bing. Fallback to OSM layer"),u=new L.TileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png")}c.addLayer(u),r.on("change",function(){var n=r.val();if(n){var o=e(n);t(o)}else a()}),c.on("click",function(e){t(e.latlng),r.val(e.latlng.lat+":"+e.latlng.lng)})})}),$(".rk-select2").each(function(){function e(e){e.select2({theme:"bootstrap"})}var t=$(this),a=t.val(),n=t.data("value"),o=t.data("ajax--url");if(o&&n&&!a){var r=$.ajax({url:o+"/init",data:{ids:n}});r.then(function(a){a.results.forEach(function(e){var a=$("<option>").text(e.text).attr("value",e.id).prop("selected",!0);t.prepend(a)}),e(t)})}else e(t)}),$(document).ready(function(){$(".rk-upload-image-container .rk-upload-result").magnificPopup({type:"image"}),$(".rk-uploader-field").each(function(){var e=$(this),t=e.siblings(".rk-upload-container");t.find("input:file").fileupload({dataType:"json",url:e.data("url")||"/upload",paramName:"file",formData:[{name:"type",value:e.data("type")||"default"}],done:function(a,n){var o=n.result;e.val(o.filename),t.find(".rk-upload-result").attr("href",o.path),t.trigger("uploaded",[o])},fail:function(e,t){console.error(t)}})}),$(".rk-upload-remove").on("click",function(e){e.preventDefault();var t=$(this).parents(".rk-upload-container");t.siblings(".rk-uploader-field").val(""),t.find(".rk-upload-result").attr("href",""),t.trigger("removed",[t])}),$(".rk-upload-image-container").on("uploaded",function(e,t){$(this).find(".rk-upload-result img").attr("src",t.path)}).on("removed",function(){$(this).find(".rk-upload-result img").attr("src","")}),$(".rk-upload-file-container").on("uploaded",function(e,t){$(this).find(".rk-upload-result").text(t.filename)}).on("removed",function(){$(this).find(".rk-upload-result").text("")})});